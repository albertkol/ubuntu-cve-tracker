import os
from http.cookiejar import MozillaCookieJar

from macaroonbakery import httpbakery


def authentication(request, payload):
    url = "http://0.0.0.0:8030/security/notices/LSN-0000-0"

    client = httpbakery.Client(cookies=MozillaCookieJar(".login"))

    if os.path.exists(client.cookies.filename):
        client.cookies.load(ignore_discard=True)

    response = client.request(request, url=url, json=payload)
    client.cookies.save(ignore_discard=True)
    print(response, response.text)


notice = {
    "cves": [
        "CVE-2019-0136",
        "CVE-2019-10207",
        "CVE-2019-13631",
        "CVE-2019-15090",
        "CVE-2019-15117",
        "CVE-2019-15118",
        "CVE-2019-15211",
        "CVE-2019-15212",
        "CVE-2019-15215",
        "CVE-2019-15217",
        "CVE-2019-15218",
        "CVE-2019-15220",
        "CVE-2019-15221",
        "CVE-2019-15223",
        "CVE-2019-15538",
        "CVE-2019-15925",
        "CVE-2019-15926",
        "CVE-2019-9506",
    ],
    "id": "LSN-0000-0",
    "instructions": "Updated instructions!",
    "published": "2019-10-04T15:38:51.032420",
    "references": [],
    "release_packages": {
        "bionic": [
            {
                "description": "Linux hardware enablement (HWE) kernel",
                "is_source": True,
                "name": "linux-hwe",
                "version": "5.0.0-31.33~18.04.1",
            },
            {
                "description": "Linux kernel for Google Container Engine (GKE) systems",
                "is_source": True,
                "name": "linux-gke-5.0",
                "version": "5.0.0-1020.20~18.04.1",
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-31-generic-lpae",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-hwe",
                "version": "5.0.0-31.33~18.04.1",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-hwe/5.0.0-31.33~18.04.1",
            },
            {
                "is_source": False,
                "name": "linux-image-snapdragon-hwe-18.04",
                "source_link": None,
                "version": "5.0.0.31.88",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-lowlatency-hwe-18.04",
                "source_link": None,
                "version": "5.0.0.31.88",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-gke-5.0",
                "source_link": None,
                "version": "5.0.0.1020.9",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-virtual-hwe-18.04",
                "source_link": None,
                "version": "5.0.0.31.88",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-generic-lpae-hwe-18.04",
                "source_link": None,
                "version": "5.0.0.31.88",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-1020-gke",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-gke-5.0",
                "version": "5.0.0-1020.20~18.04.1",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-gke-5.0/5.0.0-1020.20~18.04.1",
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-31-lowlatency",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-hwe",
                "version": "5.0.0-31.33~18.04.1",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-hwe/5.0.0-31.33~18.04.1",
            },
            {
                "is_source": False,
                "name": "linux-image-generic-hwe-18.04",
                "source_link": None,
                "version": "5.0.0.31.88",
                "version_link": None,
            },
        ],
        "disco": [
            {
                "description": "Linux kernel",
                "is_source": True,
                "name": "linux",
                "version": "5.0.0-31.33",
            },
            {
                "description": "Linux kernel for cloud environments",
                "is_source": True,
                "name": "linux-kvm",
                "version": "5.0.0-1019.20",
            },
            {
                "description": "Linux kernel for Snapdragon processors",
                "is_source": True,
                "name": "linux-snapdragon",
                "version": "5.0.0-1023.24",
            },
            {
                "description": "Linux kernel for Amazon Web Services (AWS) systems",
                "is_source": True,
                "name": "linux-aws",
                "version": "5.0.0-1018.20",
            },
            {
                "description": "Linux kernel for Raspberry Pi 2",
                "is_source": True,
                "name": "linux-raspi2",
                "version": "5.0.0-1019.19",
            },
            {
                "description": "Linux kernel for Microsoft Azure Cloud systems",
                "is_source": True,
                "name": "linux-azure",
                "version": "5.0.0-1022.23",
            },
            {
                "description": "Linux kernel for Google Cloud Platform (GCP) systems",
                "is_source": True,
                "name": "linux-gcp",
                "version": "5.0.0-1020.20",
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-1022-azure",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-azure",
                "version": "5.0.0-1022.23",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-azure/5.0.0-1022.23",
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-31-generic-lpae",
                "source_link": "https://launchpad.net/ubuntu/+source/linux",
                "version": "5.0.0-31.33",
                "version_link": "https://launchpad.net/ubuntu/+source/linux/5.0.0-31.33",
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-1019-raspi2",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-raspi2",
                "version": "5.0.0-1019.19",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-raspi2/5.0.0-1019.19",
            },
            {
                "is_source": False,
                "name": "linux-image-generic",
                "source_link": None,
                "version": "5.0.0.31.32",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-gcp",
                "source_link": None,
                "version": "5.0.0.1020.46",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-31-generic",
                "source_link": "https://launchpad.net/ubuntu/+source/linux",
                "version": "5.0.0-31.33",
                "version_link": "https://launchpad.net/ubuntu/+source/linux/5.0.0-31.33",
            },
            {
                "is_source": False,
                "name": "linux-image-gke",
                "source_link": None,
                "version": "5.0.0.1020.46",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-azure",
                "source_link": None,
                "version": "5.0.0.1022.21",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-1023-snapdragon",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-snapdragon",
                "version": "5.0.0-1023.24",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-snapdragon/5.0.0-1023.24",
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-1019-kvm",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-kvm",
                "version": "5.0.0-1019.20",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-kvm/5.0.0-1019.20",
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-1020-gcp",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-gcp",
                "version": "5.0.0-1020.20",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-gcp/5.0.0-1020.20",
            },
            {
                "is_source": False,
                "name": "linux-image-raspi2",
                "source_link": None,
                "version": "5.0.0.1019.16",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-generic-lpae",
                "source_link": None,
                "version": "5.0.0.31.32",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-snapdragon",
                "source_link": None,
                "version": "5.0.0.1023.16",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-aws",
                "source_link": None,
                "version": "5.0.0.1018.19",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-kvm",
                "source_link": None,
                "version": "5.0.0.1019.19",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-1018-aws",
                "source_link": "https://launchpad.net/ubuntu/+source/linux-aws",
                "version": "5.0.0-1018.20",
                "version_link": "https://launchpad.net/ubuntu/+source/linux-aws/5.0.0-1018.20",
            },
            {
                "is_source": False,
                "name": "linux-image-lowlatency",
                "source_link": None,
                "version": "5.0.0.31.32",
                "version_link": None,
            },
            {
                "is_source": False,
                "name": "linux-image-5.0.0-31-lowlatency",
                "source_link": "https://launchpad.net/ubuntu/+source/linux",
                "version": "5.0.0-31.33",
                "version_link": "https://launchpad.net/ubuntu/+source/linux/5.0.0-31.33",
            },
            {
                "is_source": False,
                "name": "linux-image-virtual",
                "source_link": None,
                "version": "5.0.0.31.32",
                "version_link": None,
            },
        ],
    },
    "summary": "Several security issues were fixed in the Linux kernel.\n",
    "title": "Linux kernel vulnerabilities",
    "description": "",
}


authentication("PUT", notice)
