# Standard library
import sys
import json

# Local
from lib.file_helpers import JsonStore, download_gzip_file
import cve_lib


cve_data = None
download_gzip_file(
    url="http://archive.ubuntu.com/ubuntu/dists/bionic/main/source/Sources.gz",
    output_filename=".cache/main.txt",
    etag_store=JsonStore(".cache/etags.json"),
)
download_gzip_file(
    url="http://archive.ubuntu.com/ubuntu/dists/bionic/universe/source/Sources.gz",
    output_filename=".cache/universe.txt",
    etag_store=JsonStore(".cache/etags.json"),
)


if len(sys.argv) > 1:
    cve_filename = sys.argv[1]
    cve_data = cve_lib.load_cve(cve_filename)


print(json.dumps(cve_data, indent=4))
